<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>××“××™×Ÿ â€” ×™×¦×™×¨×ª ××¤×ª×—×•×ª | ×ª×¤×™×œ×” ××”×©×§×˜</title>
  <link href="https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Frank Ruhl Libre',serif; }
    body { background:#0a0a0a; color:white; min-height:100vh; display:flex; flex-direction:column; align-items:center; padding:40px 20px; }
    h1 { font-size:28px; font-weight:900; margin-bottom:8px; }
    .subtitle { color:rgba(255,255,255,0.4); font-size:14px; margin-bottom:30px; }
    .card { background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:20px; padding:30px; max-width:500px; width:100%; margin-bottom:20px; }
    label { display:block; font-size:12px; font-weight:700; color:rgba(217,119,6,0.8); margin-bottom:6px; letter-spacing:2px; }
    input, select { width:100%; padding:14px 16px; border-radius:14px; border:1.5px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:white; font-size:16px; font-weight:700; text-align:center; outline:none; margin-bottom:16px; font-family:inherit; }
    input:focus, select:focus { border-color:#b45309; }
    select option { background:#1a1a1a; color:white; }
    .row { display:flex; gap:12px; }
    .row > * { flex:1; }
    button { width:100%; padding:16px; border:none; border-radius:16px; font-size:18px; font-weight:900; cursor:pointer; transition:all 0.3s; font-family:inherit; }
    button:active { transform:scale(0.97); }
    .btn-generate { background:linear-gradient(135deg,#b45309,#92400e); color:white; margin-top:8px; }
    .btn-generate:hover { opacity:0.9; }
    .result { margin-top:20px; background:rgba(217,119,6,0.08); border:2px solid rgba(217,119,6,0.3); border-radius:16px; padding:24px; text-align:center; }
    .result-key { font-family:monospace; font-size:18px; font-weight:900; color:#f59e0b; letter-spacing:2px; margin:12px 0; padding:16px; background:rgba(0,0,0,0.3); border-radius:12px; word-break:break-all; direction:ltr; }
    .result-info { font-size:13px; color:rgba(255,255,255,0.5); margin-top:8px; }
    .btn-copy { background:rgba(255,255,255,0.1); color:white; border:1px solid rgba(255,255,255,0.15); margin-top:12px; font-size:14px; padding:12px; }
    .btn-copy:hover { background:rgba(255,255,255,0.2); }
    .copied { color:#25D366; font-size:13px; margin-top:8px; font-weight:700; }
    .history { max-width:500px; width:100%; }
    .history h2 { font-size:18px; margin-bottom:12px; color:rgba(217,119,6,0.7); }
    .history-item { background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); border-radius:12px; padding:14px; margin-bottom:8px; display:flex; justify-content:space-between; align-items:center; }
    .history-key { font-family:monospace; font-size:12px; color:#f59e0b; direction:ltr; }
    .history-dates { font-size:11px; color:rgba(255,255,255,0.35); }
    .history-copy { background:none; border:1px solid rgba(255,255,255,0.1); color:white; width:auto; padding:6px 14px; font-size:11px; border-radius:8px; }
  </style>
</head>
<body>
  <h1>ğŸ”‘ ××—×•×œ×œ ××¤×ª×—×•×ª</h1>
  <p class="subtitle">××“××™×Ÿ â€” ×¡×˜×•×“×™×• ×ª×¤×™×œ×” ××”×©×§×˜</p>

  <div class="card">
    <label>×©× ×”××™×¨×•×¢ / ×”××¤×™×§×”:</label>
    <input type="text" id="eventName" placeholder="×œ××©×œ: ×—×ª×•× ×ª ×™×•×¡×™ ×•××™×›×œ" />

    <label>×ª××¨×™×š ×”×ª×—×œ×”:</label>
    <input type="date" id="startDate" />

    <label>××©×š ×”×¨×™×©×™×•×Ÿ:</label>
    <select id="duration">
      <option value="3">3 ×©×¢×•×ª</option>
      <option value="6">6 ×©×¢×•×ª</option>
      <option value="12">12 ×©×¢×•×ª</option>
      <option value="24" selected>×™×•× ××—×“ (24 ×©×¢×•×ª)</option>
      <option value="48">×™×•××™×™×</option>
      <option value="72">3 ×™××™×</option>
      <option value="168">×©×‘×•×¢</option>
      <option value="720">×—×•×“×©</option>
    </select>

    <button class="btn-generate" onclick="generateKey()">âœ¨ ×¦×•×¨ ××¤×ª×— ×¨×™×©×™×•×Ÿ</button>

    <div id="result" style="display:none"></div>
  </div>

  <div class="history" id="historySection" style="display:none">
    <h2>ğŸ“‹ ××¤×ª×—×•×ª ×©× ×•×¦×¨×•</h2>
    <div id="historyList"></div>
  </div>

  <script>
    // Set default start date to today
    const today = new Date();
    document.getElementById('startDate').value = today.toISOString().split('T')[0];

    function generateKey() {
      const eventName = document.getElementById('eventName').value.trim() || '××™×¨×•×¢';
      const startDateStr = document.getElementById('startDate').value;
      const durationHours = parseInt(document.getElementById('duration').value);

      if (!startDateStr) { alert('×‘×—×¨×• ×ª××¨×™×š ×”×ª×—×œ×”'); return; }

      const startDate = new Date(startDateStr);
      const endDate = new Date(startDate.getTime() + durationHours * 60 * 60 * 1000);

      // Format dates as YYYYMMDD
      const fmt = (d) => d.getFullYear().toString() +
        (d.getMonth()+1).toString().padStart(2,'0') +
        d.getDate().toString().padStart(2,'0');

      // Random 4-char code
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      for (let i = 0; i < 4; i++) code += chars[Math.floor(Math.random() * chars.length)];

      const key = `TFILA-${fmt(startDate)}-${fmt(endDate)}-${code}`;

      // Show result
      const resultDiv = document.getElementById('result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <div style="font-size:14px;color:rgba(255,255,255,0.6);font-weight:700;">××¤×ª×— ×—×“×© × ×•×¦×¨!</div>
        <div class="result-key" id="keyText">${key}</div>
        <div class="result-info">
          ğŸ“Œ ${eventName}<br>
          ğŸ“… ${startDate.toLocaleDateString('he-IL')} ×¢×“ ${endDate.toLocaleDateString('he-IL')}<br>
          â±ï¸ ${durationHours} ×©×¢×•×ª
        </div>
        <button class="btn-copy" onclick="copyKey()">ğŸ“‹ ×”×¢×ª×§ ××¤×ª×—</button>
        <div id="copiedMsg"></div>
      `;

      // Save to history
      const history = JSON.parse(localStorage.getItem('tfila_admin_keys') || '[]');
      history.unshift({ key, event: eventName, start: startDateStr, end: endDate.toISOString().split('T')[0], hours: durationHours, created: new Date().toISOString() });
      localStorage.setItem('tfila_admin_keys', JSON.stringify(history));
      renderHistory();
    }

    function copyKey() {
      const key = document.getElementById('keyText').textContent;
      navigator.clipboard.writeText(key).then(() => {
        document.getElementById('copiedMsg').innerHTML = '<p class="copied">âœ“ ×”×•×¢×ª×§!</p>';
      });
    }

    function copyHistoryKey(key) {
      navigator.clipboard.writeText(key).then(() => {
        alert('×”×•×¢×ª×§: ' + key);
      });
    }

    function renderHistory() {
      const history = JSON.parse(localStorage.getItem('tfila_admin_keys') || '[]');
      const section = document.getElementById('historySection');
      const list = document.getElementById('historyList');

      if (history.length === 0) { section.style.display = 'none'; return; }
      section.style.display = 'block';

      list.innerHTML = history.map(item => `
        <div class="history-item">
          <div>
            <div class="history-key">${item.key}</div>
            <div class="history-dates">ğŸ“Œ ${item.event} | ğŸ“… ${item.start} â†’ ${item.end} | â±ï¸ ${item.hours}h</div>
          </div>
          <button class="history-copy" onclick="copyHistoryKey('${item.key}')">ğŸ“‹</button>
        </div>
      `).join('');
    }

    // Initial render
    renderHistory();
  </script>
</body>
</html>
